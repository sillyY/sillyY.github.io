(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{310:function(e,t,r){"use strict";r.r(t);var a=r(9),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"vuepress-插件开发总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vuepress-插件开发总结","aria-hidden":"true"}},[e._v("#")]),e._v(" vuepress 插件开发总结")]),e._v(" "),r("p",[e._v("由于某个组件库("),r("a",{attrs:{href:"http://sillyy.cn/ele-vue/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ele-vue"),r("OutboundLink")],1),e._v(")的文档缘故，故打算去开发 vuepress 的插件("),r("a",{attrs:{href:"http://sillyy.cn/vuepress-plugin-code-segment/",target:"_blank",rel:"noopener noreferrer"}},[e._v("vuepress-plugin-code-segment"),r("OutboundLink")],1),e._v(")来帮助生产 demo 和 code。其间历时 1 个多月，总算幸不辱命。故在此记录其中艰辛。")]),e._v(" "),r("h3",{attrs:{id:"收集资料阶段"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#收集资料阶段","aria-hidden":"true"}},[e._v("#")]),e._v(" 收集资料阶段")]),e._v(" "),r("p",[e._v("开始在网上搜寻相关资料，找到 2 个库("),r("a",{attrs:{href:"https://github.com/xiguaxigua/vuepress-plugin-demo-block",target:"_blank",rel:"noopener noreferrer"}},[e._v("vuepress-plugin-demo-block"),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://github.com/BuptStEve/vuepress-plugin-demo-code",target:"_blank",rel:"noopener noreferrer"}},[e._v("vuperess-plugin-demo-code"),r("OutboundLink")],1),e._v(")."),r("br"),e._v("\n本来打算直接使用的，开始尝试 demo-code 这个库，后来发现该库是加载一个组件到页面中去，故当同一个页面存在多个展示 demo，2 个组件中 data 是同一个 data，故会让开发很不舒服."),r("br"),e._v("\n其次尝试了 demo-block，该库检测：每有一个展示 demo，就去生成一个 demo，虽然解决了 demo-code 的问题，但其本身缺少 demo-code 的属性自定义的特点，而且作者好像不再维护.")]),e._v(" "),r("h3",{attrs:{id:"开发问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#开发问题","aria-hidden":"true"}},[e._v("#")]),e._v(" 开发问题")]),e._v(" "),r("h4",{attrs:{id:"_1-vuepress-版本区别"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-vuepress-版本区别","aria-hidden":"true"}},[e._v("#")]),e._v(" 1.vuepress 版本区别")]),e._v(" "),r("p",[e._v("v0.x 和 v1.x 之间是存在很大区别，v1.x 将模块解耦，改变成插件的模式去集成，顾名思义，就是 v0.x 版本不存在插件系统")]),e._v(" "),r("blockquote",[r("p",[e._v("tip: 关于这点，我真的调研了很久，之前一直没注意 vuepress 存在 2 个版本。老实说，vuepress 相关文档真的是少，全是抄着官方文档去搭建 vuepress 博客，真的是毫无意义。")])]),e._v(" "),r("h4",{attrs:{id:"_2-插件-option-api"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-插件-option-api","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.插件 Option API")]),e._v(" "),r("blockquote",[r("p",[e._v("tip: 这里是插件的 Option API，不是 vuepress 的配置 API")])]),e._v(" "),r("ul",[r("li",[r("p",[e._v("extendMarkdown(Option API)"),r("br"),e._v("\n这个是用于修改 markdown 文件，我这次主要使用该 API，后面会着重讲。")])]),e._v(" "),r("li",[r("p",[e._v("clientRootMixin(Option API)"),r("br"),e._v("\n类似于混入，该文件可以控制根组件生命周期。")])]),e._v(" "),r("li",[r("p",[e._v("define(Option API)"),r("br"),e._v("\n如果想在 clientRootMixin 使用配置文件,可以在这里将 option 定义成全局配置")])])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("{\n    define: {\n      SETTINGS:  options\n    }\n}\n")])])]),r("h4",{attrs:{id:"_3-extendmarkdown-api-和-markdown-it、markdown-it-container依赖"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-extendmarkdown-api-和-markdown-it、markdown-it-container依赖","aria-hidden":"true"}},[e._v("#")]),e._v(" 3.extendMarkdown API 和 "),r("a",{attrs:{href:"https://github.com/markdown-it/markdown-it",target:"_blank",rel:"noopener noreferrer"}},[e._v("markdown-it"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://github.com/markdown-it/markdown-it-container",target:"_blank",rel:"noopener noreferrer"}},[e._v("markdown-it-container"),r("OutboundLink")],1),e._v("依赖")]),e._v(" "),r("ul",[r("li",[e._v("extendMarkdown")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("module.exports = {\n  extendMarkdown: md => {\n    md.set({ breaks: true }) // 转换段落里的 '\\n' 到 <br>。\n    md.use(require('markdown-it-xxx')) // 使用某个依赖\n  }\n}\n")])])]),r("ul",[r("li",[r("p",[e._v("markdown-it"),r("br"),e._v("\nmarkdown 文件的解析库，目前大部分的 markdown 库都是基于它开发的。有没有别的，抱歉，我也不知道。")])]),e._v(" "),r("li",[r("p",[e._v("markdown-it-container"),r("br"),e._v("\n创建自定义结构的块容器")])])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("::: warning\n*here be dragons*\n:::\n")])])]),r("p",[e._v("👇")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('<div class="warning">\n<em>here be dragons</em>\n</div>\n')])])]),r("p",[e._v("可以识别含有指定标志(上面是 warning)的代码块,对代码块中的文档进行处理，从而生成指定的代码块。")]),e._v(" "),r("blockquote",[r("p",[e._v("tip: 这里也花了好久，主要是在研究 markdown-it 和 markdown-it-container 这 2 个依赖上.")])]),e._v(" "),r("h4",{attrs:{id:"_4-debugger-问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-debugger-问题","aria-hidden":"true"}},[e._v("#")]),e._v(" 4.debugger 问题")]),e._v(" "),r("ul",[r("li",[e._v("首先插件的开发文件是 node 环境，请记住你常常会存在修改了代码，但无效的情况."),r("br"),e._v("\n因为 vuepress 的加载方式是,先加载 node 部分,再加载 web 部分.而插件的开发文件在第一次启动生成一遍,但修改该文件并不会触发热更新,因为 vuepress 只监听它的 markdown 文件.所以即使你修改了代码,但你使用加载的都是缓存里的第一次启动的代码.")])]),e._v(" "),r("p",[e._v("解决方案:")]),e._v(" "),r("p",[e._v("1.设置 extraWatchFiles,这里监听插件开发文件")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("module.exports = {\n  extraWatchFiles: [\n    '.vuepress/foo.js', // 使用相对路径\n    '/path/to/bar.js'   // 使用绝对路径\n  ]\n}\n")])])]),r("ol",{attrs:{start:"2"}},[r("li",[e._v("设置 vuepress-cli 命令")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('{\n  "scripts": {\n    "start": "vuepress dev docs --no-clear-screen --no-cache --temp .temp",\n  },\n}\n')])])]),r("p",[e._v("--no-clear-screen 不清除屏幕"),r("br"),e._v("\n--no-cache 不缓存"),r("br"),e._v("\n--temp .temp 指定客户端文件的临时目录。")]),e._v(" "),r("ol",{attrs:{start:"3"}},[r("li",[e._v("在测试 Markdown 文件中加入以下文本:")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("第001次测试(修改数字,强制触发vuepress更新)\n")])])]),r("ul",[r("li",[e._v("好的一点是 clientRootMixin 里混入的文件又是在网页环境中,故这里面的代码修改会实时更新.")])]),e._v(" "),r("blockquote",[r("p",[e._v("tip: vuepress 的热更新真的让我蛮绝望,特别是对插件开发极其不友好,debugger 太痛苦.")])]),e._v(" "),r("h4",{attrs:{id:"_5-插件开发不支持本地图片-不排除可以解决的可能性-这方面资料实在太少-暂时没有解决办法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-插件开发不支持本地图片-不排除可以解决的可能性-这方面资料实在太少-暂时没有解决办法","aria-hidden":"true"}},[e._v("#")]),e._v(" 5.插件开发不支持本地图片(不排除可以解决的可能性,这方面资料实在太少,暂时没有解决办法.)")]),e._v(" "),r("p",[e._v("因为 vuepress 里的静态资源都在.vuepress/public 里,本地图片放到这里面,不就等同于用户需要放置一张一样的图片到 public 里.而外部的图片地址又无法加载进去.")]),e._v(" "),r("blockquote",[r("p",[e._v("tip: 可以使用图片cdn的方式来解决吧.")])]),e._v(" "),r("Valine")],1)}),[],!1,null,null,null);t.default=n.exports}}]);